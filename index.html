<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>KimArts Print Ads</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>ðŸ“„ KimArts Print Ads</header>
  <main>
    <section>
      <h2>Inventory</h2>
      <div id="dynamicInventoryItems">
        <!-- Content will be generated by JavaScript -->
      </div>
      
      <label>Price B&W: â‚±<input type="number" id="priceBW" value="1" disabled></label>
      <label>Price Color: â‚±<input type="number" id="priceColor" value="5" disabled></label>
      
      <!-- Displaying Initial Estimated Profits (Baselines) -->
      <p>Total Estimated Profit (Standard B&W): â‚±<span id="estProfitStandardBW">0</span></p>
      <p>Total Estimated Profit (Standard Color): â‚±<span id="estProfitStandardColor">0</span></p>
      <p>Total Estimated Photo Paper Profit: â‚±<span id="estProfitPhotoPaper">0</span></p>

      <hr style="border: none; border-top: 1px dashed #ddd; margin: 15px 0;">

      <!-- Displaying Current Inventory Values -->
      <p>Current Inventory Value (Standard B&W): â‚±<span id="currentInventoryValueStandardBW">0</span></p>
      <p>Current Inventory Value (Standard Color): â‚±<span id="currentInventoryValueStandardColor">0</span></p>
      <p>Current Inventory Value (Photo Paper): â‚±<span id="currentInventoryValuePhotoPaper">0</span></p>
      
      <div id="inventoryControlButtons" class="button-group-vertical">
        <button id="editInventoryBtn" onclick="toggleEditMode()">Edit Inventory</button>
        <button id="addPaperTypeBtn" onclick="showAddPaperModal()">Add New Paper Type</button>
        <button id="managePricingBtn" onclick="showManagePricingModal()">Manage Pricing</button>
        <button id="resetInventoryBtn" onclick="resetInventory()">Reset Inventory</button>
        <button id="cancelEditBtn" onclick="cancelEditMode()" style="display: none; background: #ccc;">Cancel</button>
      </div>
    </section>

    <section>
      <h2>Print Job</h2>
      <label>Paper Type:
        <select id="paperType">
          <!-- Options will be dynamically populated -->
        </select>
      </label>
      <label>Print Type:
        <select id="printType" onchange="togglePrintJobInputs()">
          <!-- Options will be dynamically populated from printJobTypes -->
        </select>
      </label>

      <!-- Standard Print Job Inputs -->
      <div id="standardPrintInputs">
        <label>B&W Pages: <input type="number" id="bw" value="0" oninput="toggleAddPrintJobButton()"></label>
        <label>Colored Pages: <input type="number" id="colored" value="0" oninput="toggleAddPrintJobButton()"></label>
        <label>Rejected B&W: <input type="number" id="rejectedBW" value="0" oninput="toggleAddPrintJobButton()"></label>
        <label>Rejected Colored: <input type="number" id="rejectedColor" value="0" oninput="toggleAddPrintJobButton()"></label>
        <button id="addPrintJobBtn" onclick="addStandardPrintJob()">Add Print Job</button>
      </div>

      <!-- Photo Bundle Job Inputs (Initially hidden) -->
      <div id="photoBundleInputs" style="display: none;">
        <label>Select Bundle:
          <select id="bundleTypeSelect"></select>
        </label>
        <label>Quantity of Bundles: <input type="number" id="bundleQuantity" value="1"></label>
        <button id="addBundleJobBtn" onclick="addPhotoBundleJob()">Add Bundle Job</button>
      </div>

      <!-- Full Page Photo Print Inputs (Initially hidden) -->
      <div id="fullPagePhotoInputs" style="display: none;">
        <label>Quantity of Photo Sheets: <input type="number" id="fullPhotoQty" value="1"></label>
        <button id="addFullPagePhotoBtn" onclick="addFullPagePhotoJob()">Add Full Page Photo Job</button>
      </div>
      
      <div class="button-group-vertical">
        <button onclick="showManagePrintTypesModal()">Manage Print Types</button>
        <button onclick="showManagePhotoBundlesModal()">Manage Photo ID Bundles</button>
      </div>
    </section>

    <section id="summarySection" style="grid-column: span 2;">
      <h2>Summary</h2>
      <label>Filter by Date Range:</label>
      <input type="date" id="startDate">
      <input type="date" id="endDate">
      
      <div class="button-group-vertical">
        <button onclick="filterByDate()">Apply Filter</button>
        <button onclick="clearDateFilter()">Clear Filter</button>
        <button onclick="exportToFile()">Save to File</button>
        <button onclick="printSummaryReport()">Print Report</button>
        <button id="importDataButton" onclick="triggerImportData()">Import Data</button> <!-- ADDED ID -->
        <input type="file" id="importFileInput" accept=".json" style="display: none;"> <!-- HIDDEN FILE INPUT -->
      </div>

      <p id="filterDisplay">Showing all data.</p>

      <h3>Job History</h3>
      <ul id="history"></ul>

      <h3>Usage Over Time</h3>
      <canvas id="usageChart" height="100"></canvas>

      <h3>Filtered Totals</h3>
      <p>Total Profit for Period: â‚±<span id="totalProfit">0</span></p>
      <p>Total Loss for Period: â‚±<span id="totalLoss">0</span></p>
      <hr style="border: none; border-top: 1px dashed #ddd; margin: 15px 0;">
      <h3>Overall Potential Remaining</h3>
      <p>Total Profit Left (Standard B&W): â‚±<span id="profitLeftStandardBW">0</span></p>
      <p>Total Profit Left (Standard Color): â‚±<span id="profitLeftStandardColor">0</span></p>
      <p>Total Profit Left (Photo Paper): â‚±<span id="profitLeftPhotoPaper">0</span></p>
    </section>
  </main>

  <!-- Setup Modal HTML -->
  <div id="setupModalOverlay">
    <div id="setupModalContent">
      <h2>Initial Setup</h2>
      <p>Please set your initial inventory for default paper types and pricing.</p>
      <label>Initial A4 Sheets: <input type="number" id="setupA4Count" value="500"></label>
      <label>Initial Letter Sheets: <input type="number" id="setupLetterCount" value="500"></label>
      <label>Initial Legal Sheets: <input type="number" id="setupLegalCount" value="500"></label>
      <label>Price B&W: â‚±<input type="number" id="setupPriceBW" value="1"></label>
      <label>Price Color: â‚±<input type="number" id="setupPriceColor" value="5"></label>
      <button onclick="saveInitialSetup()">Save Setup</button>
    </div>
  </div>

  <!-- Add New Paper Type Modal HTML -->
  <div id="addPaperModalOverlay">
    <div id="addPaperModalContent">
      <h2>Add New Paper Type</h2>
      <label>Paper Type Name: <input type="text" id="newPaperTypeName" placeholder="e.g., Glossy A3"></label>
      <label>Category:
        <select id="newPaperTypeCategory">
          <option value="standard">Standard</option>
          <option value="photo">Photo</option>
        </select>
      </label>
      <label>Initial Count: <input type="number" id="newPaperTypeCount" value="0"></label>
      <button onclick="addNewPaperType()">Add Paper Type</button>
      <button onclick="hideAddPaperModal()" style="background: #ccc; margin-top: 10px;">Cancel</button>
    </div>
  </div>

  <!-- Manage Print Types Modal HTML -->
  <div id="managePrintTypesModalOverlay">
    <div id="managePrintTypesModalContent">
      <h2>Manage Print Job Types</h2>
      <div class="modal-section">
        <h3>Existing Types</h3>
        <ul id="printTypeManagementList">
          <!-- Dynamically populated -->
        </ul>
        <button onclick="saveAllPrintTypeChanges()">Save Print Type Changes</button>
      </div>
      <div class="modal-section">
        <h3>Add New Type</h3>
        <label>Type Name: <input type="text" id="newPrintTypeName" placeholder="e.g., Large Format"></label>
        <label>Type:
          <select id="newPrintJobTypeCategory">
            <option value="standard">Standard Print</option>
            <option value="photo_bundle">Photo Bundle</option>
            <option value="full_page_photo">Full Page Photo</option>
          </select>
        </label>
        <label>Price Multiplier: <input type="number" step="0.01" id="newPrintTypeMultiplier" value="1.0"></label>
        <label>Base Price: â‚±<input type="number" step="0.01" id="newPrintTypeBasePrice" value="0.0"></label>
        <label>Bundle Quantity: <input type="number" id="newPrintTypeBundleQuantity" value="0"></label>
        <button onclick="addNewPrintType()">Add New Type</button>
      </div>
      <div class="modal-buttons">
        <button onclick="hideManagePrintTypesModal()" style="background: #ccc;">Done</button>
      </div>
    </div>
  </div>

  <!-- Edit Job Modal HTML -->
  <div id="editJobModalOverlay">
    <div id="editJobModalContent">
      <h2>Edit Print Job</h2>
      <p>Editing Job ID: <span id="editJobIndexDisplay"></span></p>
      <label>Date: <input type="date" id="editJobDate"></label>
      <label>Paper Type:
        <select id="editJobPaperType">
          <!-- Options will be dynamically populated -->
        </select>
      </label>
      <label>Print Type:
        <select id="editJobPrintType">
          <!-- Options will be dynamically populated -->
        </select>
      </label>

      <!-- Fields for Standard Print Job Edit -->
      <div id="editStandardPrintFields">
        <label>B&W Pages: <input type="number" id="editJobBW"></label>
        <label>Colored Pages: <input type="number" id="editJobColored"></label>
        <label>Rejected B&W: <input type="number" id="editJobRejectedBW"></label>
        <label>Rejected Colored: <input type="number" id="editJobRejectedColor"></label>
      </div>

      <!-- Fields for Photo Bundle Job Edit -->
      <div id="editPhotoBundleFields" style="display: none;">
        <label>Bundle Name: <select id="editJobBundleName"></select></label>
        <label>Bundle Quantity: <input type="number" id="editJobBundleQuantity"></label>
      </div>

      <!-- Fields for Full Page Photo Job Edit -->
      <div id="editFullPagePhotoFields" style="display: none;">
        <label>Quantity of Photo Sheets: <input type="number" id="editJobFullPhotoQty"></label>
      </div>

      <button onclick="saveEditedJob()">Save Changes</button>
      <button onclick="hideEditJobModal()" style="background: #ccc; margin-top: 10px;">Cancel</button>
    </div>
  </div>

  <!-- Manage Photo ID Bundles Modal HTML -->
  <div id="managePhotoBundlesModalOverlay">
    <div id="managePhotoBundlesModalContent">
      <h2>Manage Photo ID Bundles</h2>
      <div class="modal-section">
        <h3>Photo Bundle Yield Settings</h3>
        <label>Paper Type for Bundles:
          <select id="photoBundlePaperType" onchange="updatePhotoYieldSettings()"></select>
        </label>
        <label>Max 2x2s per A4: <input type="number" id="max2x2PerA4" value="0" onchange="updatePhotoYieldSettings()"></label>
        <label>Max 1x1s per A4: <input type="number" id="max1x1PerA4" value="0" onchange="updatePhotoYieldSettings()"></label>
        <p class="yield-explanation">
          * "Estimated Value per Photo Paper Sheet" is used for Inventory Profit/Value metrics and for "Full Page Photo Print" job type.
          <br>
          * "Max 2x2s/1x1s per A4" are used to calculate sheet consumption for Photo ID Bundles.
        </p>
      </div>
      <div class="modal-section">
        <h3>Existing Bundles</h3>
        <ul id="photoBundleManagementList">
          <!-- Dynamically populated -->
        </ul>
        <button onclick="saveAllPhotoBundleChanges()">Save Bundle Changes</button>
      </div>
      <div class="modal-section">
        <h3>Add New Bundle</h3>
        <label>Bundle Name: <input type="text" id="newBundleName" placeholder="e.g., Set A"></label>
        <label>Price: â‚±<input type="number" step="0.01" id="newBundlePrice" value="0.0"></label>
        <label>2x2 Photos: <input type="number" id="newBundle2x2Count" value="0"></label>
        <label>1x1 Photos: <input type="number" id="newBundle1x1Count" value="0"></label>
        <button onclick="addNewPhotoBundle()">Add New Bundle</button>
      </div>
      <div class="modal-buttons">
        <button onclick="hideManagePhotoBundlesModal()" style="background: #ccc;">Done</button>
      </div>
    </div>
  </div>

  <!-- Manage Pricing Modal HTML -->
  <div id="managePricingModalOverlay">
    <div id="managePricingModalContent">
      <h2>Manage Pricing</h2>
      <div class="modal-section">
        <h3>Existing Prices</h3>
        <ul id="pricingManagementList">
          <!-- Dynamically populated -->
        </ul>
        <button onclick="saveAllPricingChanges()">Save Price Changes</button>
      </div>
      <div class="modal-section">
        <h3>Add New Price Entry</h3>
        <label>Price Name: <input type="text" id="newPriceName" placeholder="e.g., Special Discount"></label>
        <label>Value: â‚±<input type="number" step="0.01" id="newPriceValue" value="0.0"></label>
        <label>Category:
          <select id="newPriceCategory">
            <option value="standard">Standard Print</option>
            <option value="photo">Photo Print</option>
            <option value="other">Other</option>
          </select>
        </label>
        <button onclick="addNewPriceEntry()">Add New Price</button>
      </div>
      <div class="modal-buttons">
        <button onclick="hideManagePricingModal()" style="background: #ccc;">Done</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>